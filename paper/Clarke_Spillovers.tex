%********************************************************************************
\documentclass{article}


\usepackage{appendix}
\usepackage{natbib}
\bibliographystyle{abbrvnat}
\bibpunct{(}{)}{;}{a}{,}{,}
\usepackage{setspace}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\newtheorem{assumption}{Assumption}
\newtheorem{proposition}{Proposition}
\usepackage{booktabs}
\usepackage[usenames, dvipsnames]{color}
\usepackage{epsfig}
\usepackage{epstopdf}
\usepackage{graphics}
\usepackage{hyperref}

\setlength\parskip{0.25in}


\hypersetup{                                                                                                    
    colorlinks=true,   
    linkcolor=BlueViolet,
    citecolor=BlueViolet,
    filecolor=BlueViolet,
    urlcolor=BlueViolet
}  



\title{Estimating Difference-in-Differences in the Presence of Spillovers\footnote{
I thank participants in the Impact Evaluation Meeting at the Inter-American 
Development Bank for useful comments on this draft. Source code, including the
Stata module \texttt{cdifdif} is available at 
https://github.com/damiancclarke/spillovers.  Affiliation: Faculty of Economics, 
The University of Oxford, Manor Road, Oxford. Contact email: 
damian.clarke@economics.ox.ac.uk}}
\author{Damian Clarke}


\begin{document}

\maketitle


\begin{abstract}
I propose a method for difference-in-differences (DD) estimation in situations 
where the stable unit treatment value assumption is violated locally. This is
relevant for a wide variety of cases where spillovers may occur between quasi-%
treatment and quasi-control areas in a (natural) experiment. A flexible 
methodology is described to test for such spillovers, and to consistently 
estimate treatment effects in their presence. This methodology is applied---both 
parametrically and semi-parametrically---to two empirical examples.
\end{abstract}
\hspace{8mm} \emph{JEL codes}: C13, C21, J13, R23. \\

\newpage
\begin{spacing}{1.1}
%********************************************************************************
\section{Introduction}
Natural experiments often rely on territorial borders to estimate treatment 
effects.  These borders separate quasi-treatment from quasi-control groups with
individuals in one area having access to a program or treatment while those in 
another do not.  In cases such as these where geographic location is used to 
motivate identification, the stable unit treatment value assumption (SUTVA) is, 
either explicitly or implicitly, invoked.\footnote{The SUTVA has a long and 
interesting history, under various guises. \citet{Cox1958} refers to ``no 
interference between different units'', before \citet{Rubin1978} introduced the 
concept of SUTVA (the name SUTVA did not appear until \citet{Rubin1980}).  
Recent work of \citet{Manski2013}, refers to this assumption as Individualistic 
Treatment Response (ITR).}

However, often territorial borders are porous.  Generally state, regional,
municipal, and village boundaries can be easily, if not costlessly, crossed.
Given this, researchers interested in using natural experiments in this way may
be concerned that the effects of a program in a treatment cluster may spillover 
into non-treatment clusters---at least locally.

Such a situation is in clear violation of the SUTVA's need that the treatment
status of any one unit must not affect the outcomes of any other unit.  In this 
paper we propose a methodology to deal with such spillover effects.  We
discuss how to test for local spillovers, and if such spillovers exist, how to 
estimate unbiased treatment effects.  It is shown that this estimation requires
a weaker condition than SUTVA: namely that SUTVA holds between \emph{some} units, 
as determined by their distance from the treatment cluster.  We show how to 
estimate treatment effects both parametrically and semi-parametrically, and then
propose a method to generalise the proposed estimator to a higher dimensional 
case where spillovers may depend, parametrically or non-parametrically, on a number 
of factors.

This methodology is then illustrated with a number of (large scale) empirical 
examples.  We examine how spillovers of reforms across municipal boundaries may 
contaminate `traditional' difference-in-differences (DD) estimators.  This is 
applied to two contraceptive reforms, where individuals from contiguous or nearby 
areas can travel to a treatment region to access the reform.  It is shown that 
both the plausibly exogenous arrival of the morning after pill to certain 
municipalities of Chile, and abortion to certain districts in Mexico results in 
a reduction of births in the given area, and in close-by quasi-control areas.  
As a result, the spillover-robust DD estimator propsed here flexibly captures 
this effect, correcting for any (local) spillover bias which traditional DD
fails to account for.

This paper joins recent literature which aims to loosen the strong strucure 
imposed by the SUTVA.  Perhaps most notably, it is (in broad terms) an 
application of \citeauthor{Manski2013}'s (2013) social interactions framework, 
focusing on the case where spillovers are restricted to areas local to treatment 
clusters.  However, unlike recent developments focusing on spillovers 
between treated and control units \emph{within} a treatment cluster (notable
examples include \citet{McIntosh2008,Bairdetal2014,AngelucciDiMaro2010}), this 
paper focuses on situations where entire clusters are treated, and the status
of the \emph{cluster} may affect nearby non-treated clusters.  This is likely
the case for quasi-experimental studies, where `experiments' are defined based
on geographic boundaries, such as administrative political regions which set 
different policies.\footnote{A very different case is that of (for example)
PROGRESA/Oportunidades, where treatment clusters (ie localities or 
\emph{localidades}) contained both treatment and control individuals, and the
literature is concerned with spillovers between treatment and control individuals
within this treatment cluster.}

\nocite{AngelucciDeGiorgi2009} \nocite{Heckmanetal1998}
\nocite{MiguelKremer2004}
 \nocite{Heckmanetal1998b}

%********************************************************************************
%SATURATE
\section{Methodology}
Define $Y(i,t)$ as the outcome for individual $i$ and time $t$.  The population
of interest is observed at two time periods, $t\in \{0,1\}$. Assume that between
$t=0$ and $t=1$, some fraction of the population is exposed to a 
quasi-experimental treatment.  As per \citet{Abadie2005}, we will denote 
treatment for individual $i$ in time $t$ as $D(i,t)$, where $D(i,1)=1$ implies 
that the individual was treated, and $D(i,1)=0$ implies that the individual was
not directly treated.  Given that treatment only exists between periods 0 and 1,
$D(i,0)=0\ \forall\ i$.

It is shown by \citet{AshenfelterCard1985} that if the outcome is generated by
a component of variance process:
\begin{equation}
\label{Seqn:COV}
Y(i,t)=\delta(t) + \alpha D(i,t)+\eta(i)+\nu(i,t)
\end{equation}
where $\delta(t)$ refers to a time-specific component, $\alpha$ as the impact of 
treatment, $\eta(i)$ a component specific to each individual, and $\nu(i,t)$ as 
a time-varying individual (mean zero) shock, then a sufficient condition for 
identification (a complete derivation is provided by \citet{Abadie2005}) is:
\begin{equation}
\label{Seqn:ID}
P(D(i,1)=1|\nu(i,t))=P(D(i,1)=1) \ \forall\ t\in\{0,1\}.
\end{equation}
In other words, identification requires that selection into treatment does not
rely on the unobserved time-varying component $\nu(i,t)$.  If this condition 
holds, then the classical DD estimator provides an unbiased estimate of the
treatment effect:
\begin{equation}
\label{Seqn:DD}
\begin{split}
\alpha&=\{E[Y(i,1)|D(i,1)=1]-E[Y(i,1)|D(i,1)=0]\} \\
      &-\{E[Y(i,0)|D(i,1)=1]-E[Y(i,0)|D(i,1)=0]\}.
\end{split}
\end{equation}

Assume now, however, that treatment is not precisely geographically bounded.  
Specifically, imagine that those living in control areas `close to' treatment 
areas are able to access treatment, either partially or completely.  Such a 
case allows for a case where individuals `defy' their treatment status, by 
travelling or moving to treated areas, or where spillovers from treatment 
areas is diffused through general equilibrium processes.  Define $R(i,t)$ 
where:
\begin{equation}
 R(i,t) =
  \begin{cases}
   1   & \text{if an individual lives close to, but not in, a treatment area} \\
   0   & \text{otherwise} 
  \end{cases}
\end{equation}
As treatment occurs only in period 1, $R(i,0)=0$ for all $i$.  Similarly, as 
living in a treatment area itself excludes individuals from living `close to' 
the same treament area, $R(i,t)=0$ for all $i$ such that $D(i,t)=1$.

Generalising from (\ref{Seqn:COV}), now we assume that $Y(i,t)$ is generated 
by:
\begin{equation}
\label{Seqn:COV2}
Y(i,t)=\delta(t) + \alpha D(i,t)+\beta R(i,t)+\eta(i)+\nu(i,t)
\end{equation}
If we observe only $Y(i,t)$, $D(i,t)$ and $R(i,t)$, a sufficient condition for 
estimation now consists of (\ref{Seqn:ID}) and the following assumption: 
\begin{equation}
\label{Seqn:ID2}
P(R(i,1)=1|\nu(i,t))=P(R(i,1)=1) \ \forall\ t\in\{0,1\}.
\end{equation}
This requires that both treatment, and being close to treatment cannot depend 
upon individual-specific time-variant components. To see this, write 
(\ref{Seqn:COV2}), adding and subtracting $E[\eta(i)|D(i,1),
R(i,1)]$:
\begin{equation}
\label{Seqn:addsub}
Y(i,t)=\delta(t) + \alpha D(i,t)+\beta R(i,t)+E[\eta(i)|D(i,1),R(i,1)]+\varepsilon(i,t)
\end{equation}
where, following \citet{Abadie2005}, $\varepsilon(i,t)=\eta(i)-E[\eta(i)|D(i,1),R(i,1)]
+\nu(i,t)$.  We can write $\delta(t)=\delta(0)+[\delta(1)-\delta(0)]t$, and write
$E[\eta(i)|D(i,1),R(i,1)]$ as the sum of the expectation of the individual-specific 
component $\eta(i)$ over treatment status and `close' status\footnote{$E[\eta(i)|
D(i,1),R(i,1)]=E[\eta(i)|D(i,1)=0,R(i,1)=0]+(E[\eta(i)|D(i,1)=1,
R(i,1)=0]-E[\eta(i)|D(i,1)=0,R(i,1)=0])\cdot D(i,1)+(E[\eta(i)|D(i,1)=0,R(i,1)=1]-
E[\eta(i)|D(i,1)=0,R(i,1)=0])\cdot R(i,1)$.}.  Finally define $\mu$ as 
$\mu=E[\eta(i)|D(i,1)=0,R(i,1)=0]+\delta_0$, $\tau$ as $\tau=E[\eta(i)|D(i,1)=1,R(i,1)
=0]-E[\eta(i)|D(i,1)=0,R(i,1)=0]$, $\gamma$ as $\gamma=E[\eta(i)|D(i,1)=0,R(i,1)=1]-
E[\eta(i)|D(i,1)=0,R(i,1)=0]$ and $\delta$ as $\delta=\delta(1)-\delta(0)$.  Then 
from the above and (\ref{Seqn:addsub})
we have:
\begin{equation}
\label{Seqn:cDD}
Y(i,t)=\mu+\tau D(i,1) + \gamma R(i,1) + \delta t + \alpha D(i,t) + \beta R(i,t) + 
       \varepsilon(i,t).
\end{equation}
Notice that this equation now includes the typical DD fixed effects $\tau$ and $\delta$
and the double difference term $\alpha$.  However it also includes `close' analogues
$\gamma$ (an initial fixed effect), and $\beta$: the effect of being `close to' a 
treatment area.

From assumptions (\ref{Seqn:ID}) and (\ref{Seqn:ID2}) it holds that $E[(1,D(i,1),R(i,1),
D(i,t),R(i,t))\cdot\varepsilon(i,t)]=0$, which implies that all parameters from
(\ref{Seqn:cDD}) are consistently estimable by OLS.  Importantly, this includes
consistent estimates of $\alpha$ and $\beta$: the effect of the program treatment 
and spillover effects on outcome variable $Y(i,t)$.  Then, from (\ref{Seqn:cDD}),
a our coefficients of interest $\alpha$ and $\beta$ are:
\begin{equation}
\label{Seqn:DDa}
\begin{split}
\alpha&=\{E[Y(i,1)|D(i,1)=1,R(i,1)=0]-E[Y(i,1)|D(i,1)=0,R(i,1)=0]\} \\
      &-\{E[Y(i,0)|D(i,1)=1,R(i,1)=0]-E[Y(i,0)|D(i,1)=0,R(i,1)=0]\}, 
\end{split}
\end{equation}
and 
\begin{equation}
\label{Seqn:DDb}
\begin{split}
\beta&=\{E[Y(i,1)|D(i,1)=0,R(i,1)=1]-E[Y(i,1)|D(i,1)=0,R(i,1)=0]\} \\
      &-\{E[Y(i,0)|D(i,1)=0,R(i,1)=1]-E[Y(i,0)|D(i,1)=0,R(i,1)=0]\}. 
\end{split}
\end{equation}
where the sample estimate of each parameter is generated by a least squares
regression of (\ref{Seqn:cDD}) using a random sample of 
$\{Y(i,t), D(i,t), R(i,t): i=1, \ldots, N, t=0, 1\}$.

%********************************************************************************
\section{A Spillover-Robust Double Differences Estimator}
\label{Sscn:estim}
We are interested in estimating difference-in-difference parameters $\alpha$ and 
$\beta$ from (\ref{Seqn:cDD}).  We will refer to these estimators respectively
as the average treatment effect on the treated (ATT), and the average treatment
effect on the close to treated (ATC).  Average treatment effects are cast in 
terms of the \citet{Rubin1974} Causal Model.

Following a potential outcome framework, we denote $Y^1(i,t)$ as the potential
outcome for some person $i$ at time $t$ if they were to receive treatment, and
$Y^0(i,t)$ if the person were not to receive treatment.  Our ATT and ATC are
thus:
\begin{eqnarray}
\label{Seqn:estim}
ATT=E[Y^1(i,1)-Y^0(i,1)|D(i)=1]\  \\
ATC=E[Y^1(i,1)-Y^0(i,1)|R(i)=1].
\end{eqnarray}
As is typical in the potential outcome literature, estimation is hindered by the
reality that only one of $Y^1(i,t)$ or $Y^0(i,t)$ is observed for a given 
individual $i$ at time $t$.  The realised outcome can thus be expressed as 
$Y(i,t)=Y^0(i,t)\cdot (1-D(i,t))(1-R(i,t))+Y^1(i,t)\cdot D(i,t)+Y^1(i,t)\cdot 
R(i,t)$, where, depending on an individual's time varying treatment and close
status, we observe either $Y^0(i,t)$ (untreated) or $Y^1(i,t)$ (treated or 
close).

Thus, in order to be able to estimate the quantities of interest, we rely on
averages over the entire population, rather than average of individual 
treatment effects.  As is typical in difference-in-differences estimation,
consistent estimation requires parallel trends assumptions.  In the case of
treatment \emph{and} local spillovers, this relies on:

\begin{assumption}
\label{Sass:PT}
\textbf{Parallel trends in treatment and control:} \\
$E[Y^0(i,1)-Y^0(i,0)|D=1,R=0]=E[Y^0(i,1)-Y^0(i,0)|D=0,R=0]$,
\end{assumption}
\begin{assumption}
\label{Sass:PTC}
\textbf{Parallel trends in close and control:} \\
$E[Y^0(i,1)-Y^0(i,0)|D=0,R=1]=E[Y^0(i,1)-Y^0(i,0)|D=0,R=0]$.
\end{assumption}

Here, for notational simplicity, $D$ and $R$ are used instead of the more 
extensive $D(i,1)$ and $R(i,1)$.  In other words, assumption \ref{Sass:PT}
and \ref{Sass:PTC} state that in the absence of treatment, the evolution
of outcomes for treated units and for units close to treatment would have
been parallel to the evolution of entirely untreated units.  This is the
fundamental DD identifying assumption of parallel trends, generalised to
hold for treatment \emph{and} close to treatment status.

In order to consistently estimate any treatment effect, some form of the
SUTVA is invoked.  This requires that each individual's treatment status does
not affect each other individual's potential outcome.  Here, we loosen SUTVA.
In the remainder of this article, it will be assumed that:
\begin{assumption}
\label{Sass:SUTVAs}
\textbf{SUTVA holds for some units:} \\
There is some subset of individuals $j\in J$ of the total population $i\in N$ 
for whom potential outcomes ($Y_j^0, Y_j^1$) are independent of the treatment 
status $D=\{0,1\}\ \forall_{i\neq j} \in N$.
\end{assumption}
\noindent Fundamentally, this assumption implies that SUTVA need not hold among 
all units.  We allow SUTVA to be violated in a specific manner:
\begin{assumption}
\label{Sass:SUTVAl}
\textbf{(A) Violations of SUTVA are observably local:} \\ 
For those individuals $i\notin J$ (ie for whom SUTVA does not hold), SUTVA is
violated due to observable spillovers $R(i,t)$, where 
$R(i,t)=\mathbf{1}_{X_i\geq d}$, with the indicator function $\mathbf{1}$
depending upon the covariate $X$ exceeding some fixed, but unknown scalar $d$.
\end{assumption}
\vspace{-4mm}
\noindent This restriction is quite general however.  It simply states that
violations of SUTVA occur in an observable way.  For example, if SUTVA does
not hold locally to the treatment area, assumption \ref{Sass:SUTVAl} implies
that we are able to define what `local' is.  While this article focuses on
an $X_i$ representing geographic distance, these derivations do not imply that 
this must be the case.  The `close' indicator $R(i,t)$ could depend on a range 
of phenomena including euclidean space, ethnic distance, or, as we return to
discuss in section \ref{Sscn:extend}, interactions between measures such as 
these and economic variables.


\begin{proposition}
\label{Pass:ATT}
Under assumptions \ref{Sass:PT} to \ref{Sass:SUTVAl}, the ATT and ATC can be 
consistently estimated by least squares when controlling, parametrically or
semi-parametrically, for $R(i,t)=\mathbf{1}_{X_i\geq d}$.
\end{proposition}


\subsection{Estimation of Treatment and Spillover Effects}
From proposition \ref{Pass:ATT}, we can consistently estimate $\alpha$
and $\beta$, our estimands of interest, with information on treatment
status, and close to treatment status, along with outcomes $Y(i,t)$ at
each point of time $t\in\{0,1\}$.  In a typical DD framework, we
observe $Y(i,t)$ and $D(i,t)$, however, do not fully observe $R(i,t)$,
and individual's close/non-close status.

We do however, assume that $X_i$, the variable measuring `distance' to
treatment is observed.  From assumption \ref{Sass:SUTVAl}, we could
thus map $X_i$ to $R(i,t)$ using the indicator function, \emph{if} we
know the scalar value $d$, which represents the threshold of what is
considered `close to treatment'.  \emph{Ex ante}, in the absence some
economic model, there is no reason to believe that $d$ will be
observed by researchers.  In the remainder of this section we discuss
how to determine $R(i,t)$ based on $X_i$, in the absence of a known
value for $d$.


Consider the case where we do not control for $R(i,t)$.  Thus our model reverts
to the traditional DD model:
\begin{equation}
\label{Seqn:tDD}
Y(i,t)=\mu+\tau D(i,1) + \delta t + \alpha D(i,t) +  \varepsilon(i,t).
\end{equation}
where now our control group for whom $D(i,1)=0$ are made up of two subgroups:
those for whom $R(i,1)=1$ and those for whom $R(i,1)=0$.\footnote{Remember, given 
that here we work with only two time periods, for all $N$, $D(i,0)=0$ and 
$R(i,0)=0$.}

\textcolor{red}{3.1 and 3.2: TBC.  Remaining sections are complete.}
%Proportion is $J/N$ and $(N-J)/N$

\subsection{Semi-Parametric Estimation of a Treatment Effect}
Robinson style back fit to get the coefficient on treatment (but not close).
\citet{Imbens2004}

%********************************************************************************
\section{An Empirical Illustration: Spillovers and Contraceptive Reforms}
We consider two empirical examples to motivate spillover-robust DD estimation.
We focus on two localised contraceptive reforms in different countries. The first
is the legalisation of abortion in Mexico city in April of 2007, and the second
the expansion of morning after pill availability in certain municipalities of 
Chile in 2008.  Both reforms were sharp, resulting in a large jump in reported
rates of contraceptive access, and arrived to only certain areas of the country.
In both cases, the geographic location of the reform was defined by the nature
of local municipal-level policies, resulting in seperate policies in different
municipalities in the country.\footnote{We refer to geographic units in each case
as municipalities.  In Mexico these are referred to as \emph{municipios}, or in 
the case of Mexico City \emph{delegaciones} and are the level below the State 
(there are 2,473 in total).  In Chile these are known as \emph{comunas}, (of 
which there are 346) and are also the level below the state.}

Contraceptive reform provides a useful test of a spillover-robust DD methodology.
Firstly, the arrival is plausibly exogenous at the level of the treated woman.
Secondly, the incentives to access contraceptives, especially post-coital 
treatments such as the morning after pill and abortion is high.  Even if a woman
is geographically excluded from a treatment municipality, given that the economic
and psychic costs of an undesired birth are very high, considerable incentives
will exist to travel to a treatment area from a non-treatment area to control
fertility.  Thirdly, contraceptive information may also be important in
determining contraceptive behaviour, and this information may travel through
(local) friendship networks.

Some further details regarding each reform are provided in the sections below.
In each case we estimate traditional difference-in-differences parameters under
the assumption that spillovers do not exist (and hence the SUTVA holds), and
then augment these estimates with the estimator discussed in the previous
sections.

\subsection{Abortion Reform in Mexico}
On April 24, 2007 Mexico City passed a law which which legalised abortion 
under all circumstances in the first 12 weeks of pregnancy (see for example
\citet{Fraser2014} for a discussion).  This was a radical change from previous 
laws which outlawed abortion in all but the extreme circumstances of rape, 
to save the mother's life, or in the case of fetal inviability.  This law was 
\emph{only} passed in Mexico City (or \emph{Distrito Federal}), the 
administrative capital, and a region of Mexico containing approximately 8\% 
of the population.

This reform has had an important effect on birth rates among all age groups,
both according to administrative records, and to microeconometric estimates
(\citet{ClarkeMuhlrad2014} provide introductory figures of the effect of the
reform).  In this paper we examine only the effect of the reform on the total
number of teenage births.  Basic statistics for other age-groups, which show 
broadly similar patterns, are appended.  Full tables are available upon 
request.

Table \ref{Stab:headline} provides estimates of the effect of the reform on
the total number of births by teenagers in treatment municipalities.  In 
column 1 we estimate as specification similar to (\ref{Seqn:tDD}): the 
traditional DD estimate which does not account for spillovers.\footnote{Rather 
than estimating (\ref{Seqn:tDD}) precisely as written, we estimate a more 
flexible specification including time varying controls, full time and
municipality fixed effects, and municipal trends.  The intution however is
similar.}  This is then extended in columns 2 and 3 to account for spillovers
(if necessary).  Columns 2 and 3 present spillover-robust DD estimates, as 
described in section \ref{Sscn:estim} and equation (\ref{Seqn:cDD}).  In the
case that spillovers exist, and that these spillovers work in the same 
direction as the treatment effect itself, we should expect that we can reject
the null that $\beta<0$.  If however, $\hat\beta$ is not significantly 
different to zero, this suggests that areas `close to treatment' are not
different from areas far away from treatment, and that augmenting the 
specification to account for local spillovers is unnecessary.

\input{../tables/Headline.tex}

Estimates from table \ref{Stab:headline} suggest that, firstly, the effect of
the abortion policy is significant in magnitude.  It reduces births among 
teenagers by 125 births per municipality per year. When comparing this to the
average level of 1632.1 in treatment municipalities, this is a sizeable (and
statistically significant) effect.  When augmenting to control for local
spillovers in columns 2 and 3, it appears that municipalities `close to' 
treatment also are affected by the reform.  For those municipalities within
10km of treatment municipalities (but not themselves treated), the effect is 
a highly statistically significant reduction of approximately 120 births.
Column 3 extends to include a range of close controls.  Here it becomes
apparent that statistically significant effects remain at least up to areas
between 10 and 20km from the nearest treatment, and negative point estimates
only disappear when travelling greater than 30km away from treatment.

\begin{figure}[htpb!]
\includegraphics[scale=0.8]{../results/Mexico/CloseEstimate1.eps}
\caption{Treatment and close to treatment effects: 15-19 year olds Mexico}
\label{SFig:MexClose}
\vspace{2mm}
\begin{footnotesize}
\textsc{Notes to figure}: Each point represents a treatment effect for the group
living $d\in [0,50]$ km from the nearest treatment municipality.  As such, the
point at 0 includes all municipalities to directly receive treatment (Mexico DF).
Standard errors are clustered at the level of the municipality.  Dotted lines 
display the 90\% confidence interval for all estimates.
\end{footnotesize}
\end{figure}
Figure \ref{SFig:MexClose} presents a graphical representation of estimates
of a vector of $\beta$ coefficients from equation (\ref{Seqn:cDD}).\footnote{
While here we focus on teenaged girls, appendix \ref{Sscn:Agraphs} presents
similar graphical results for other age groups.}  While the largest effect of 
treatment is felt in the treatment municipality itself, effects clearly remain 
even outside of treatment municipalities, suggesting that the spillover robust 
specification is necessary to estimate causal effects $\hat\alpha$ and 
$\hat\beta$.

\subsection{Emergency Contraceptive Reform in Chile}
After considerable juridical challenges against the legality of emergency 
(post-coital) contraception in the country, a Chilean constitutional tribunal in 
2008 issued a summary expressly allowing the morning after pill\footnote{The morning
  after pill is a hormonal treatment composed of progestin and estrogen which acts
to prevent ovulation after sexual intercourse in which alternative forms of 
contraceptives were not used, or believed to have failed.} to be prescribed
to women.  However, this finding was limited to municipal health centres, which
are administered by mayors and local governing councils.  This resulted in a 
period of approximately 4 years where the morning after pill was available to
women \emph{only} if the mayor of her municipality deemed it appropriate.  The
reform eventually resulted in morning after pill availability in approximately
150 of the 346 municipalities of the country (further figures and details of the
reform are discussed in \citet{Clarke2014}).

As for the case of the Mexico abortion reform, a `traditional' DD specification
is esimtaed, and compared with a spillover-robust DD estimator as proposed in
section \ref{Sscn:estim}.  A generalised version of (\ref{Seqn:tDD}) is estimated
(where full year and municipal fixed effects are added, and municipal linear 
trends and time-varying controls are included), and compared to an identical
varsion of the equation robust to spillovers between treatment and 
close-to-treatment areas (\ref{Seqn:cDD}).  If the traditional DD approach 
adequately captures the treatment, or in other words if SUTVA holds even locally,
then we should see two things: firstly, our estimate of $\alpha$ from 
(\ref{Seqn:tDD}) should not be significantly different to that from (\ref{Seqn:cDD}).
Secondly, the coefficient on $R(i,t)$ should not be significantly different to
zero.  Formally, if we cannot reject the null that $\beta=0$, this is evidence 
against the need for spillover robust DD in this case.  

Columns 4 to 6 of table \ref{Stab:headline} present estimates from the Chile
reform.  In this case the variable $Y(i,t)$ represents the probability of giving
birth at time $t$, a binary outcome taking either 0 or 1 for each individual aged 
15-19 years. Column 4 presents an estimate where treatment is defined as having
the morning after pill available in the municipality where a woman lives one
year prior to the realised birth outcome (birth versus no birth).  The lag of
one year accounts for the mechanical delay in realisations of $Y(i,t)$ due to 
child gestation.  This alone suggests important effects of the reform: having the
reform available in the municipality of residence of the woman is associated with
a 4.2\% reduction in births the following year.  However, in columns (5) and (6),
we see that na\"ive estimates which fail to account for (local) spillovers 
\emph{understate} the true importance of the reform.  Column 5 suggests that
for girls living very close to the reform area, the reform appears to be at least
as important, even though their municipality is not directly treated.  Indeed,
we cannot reject tests for the equality of coefficients between those living
in treatment municipalities and those living within 10km of treatment 
municipalities.  Column 6 includes additional `close' binary variables, and
these tests suggest that the effect of the reform is able to travel around 30km;
reasonably similar to the effects of the Mexico abortion reform discussed in 
the previous section.

\begin{figure}[htpb!]
\includegraphics[scale=0.8]{../results/Chile/CloseEstimate1.eps}
\caption{Treatment Effects: 15-19 year olds Chile}
\label{Sfig:ChileAlpha}
\vspace{2mm}
\begin{footnotesize}
\textsc{Notes to figure}: Each point represents a treatment effect on the treatment
area, conditioning on close controls for $d\in [0,45]$ km from the nearest treatment 
municipality.  As such, the point at 0 includes all municipalities with the exception
of treatment municipalities in the control group.  Standard errors are clustered at 
the level of the municipality.  Dotted lines display the 90\% confidence interval for 
all estimates.
\end{footnotesize}
\end{figure}

These results clearly suggest that we \emph{can} reject the null that $\beta=0$, as
a number of `close' coefficients are significant, in some cases even up to $p=0.01$.
However, tests directly on $\alpha$ do not allow for us to reject that values 
estimated for various models are significantly different.  Examining estimates 
$\hat\alpha$ more carefully suggests that as we move further away from the reform,
the effect size monotonically decreases (figure \ref{Sfig:ChileAlpha}).  This is
precisely in-line with what we would expect if SUTVA were violated locally, and
the cost (both psychic and economic) of travelling to treatment municipalities
increased with distance.

\subsection{Running Additional Placebo Tests}
Typically, DD estimates are presented along with placebo tests which define `false'
lagged reforms.  In other words, by examining outcomes entirely \emph{before} the
policy of interest has been implemented, null results are presented as evidence
in favour of an appropriately specified functional form of the DD set-up.

In the case of the spillover-robust DD estimate, there are now (at least) two
relevant placebos which should be tested.  Firstly, the reform must not have any
effect on outcomes \emph{before} treatment in treatment municipalities.  This is
precisely the same as the `traditional' placebo test described above.  Secondly
however, the reform should have no effect on predetermined outcomes in municipalites
\emph{close} to treatment municipalities.  Below we present an example of such 
placebo tests from the Mexico City abortion reform.  Now, as well as having a 
treatment estimate not significantly different from 0 (ie confidence intervals
at $distance=0$), the same result should hold for close municipalities ($distance>0$).
\begin{figure}[htpb!]
\includegraphics[scale=0.76]{../results/Mexico/ClosePlacebo1.eps}
\caption{Treatment and Close, Placebo Tests: 15-19 year olds Mexico}
\label{SFig:MexClose}
\vspace{2mm}
\begin{footnotesize}
\textsc{Notes to figure}: Each point represents a placebo treatment effect for the 
group living $d\in [0,50]$ km from the nearest treatment municipality three years
\emph{prior} to the reform.  All births were realised entirely before the reform
began.  Standard errors are clustered at the level of the municipality.  Dotted 
lines display the 90\% confidence interval for all estimates.
\end{footnotesize}
\end{figure}


\section{Extensions}
\label{Sscn:extend}
\subsection{Estimating with Multidimensional Spillovers}
In order to allow for spillovers to depend upon a range of observable variables,
we must generalise assumption \ref{Sass:SUTVAl}.  In order to do this, the
following new terminology is introduced, following \citet{Zajonc2012}. An 
assignment rule, $\delta$, maps units with covariates $\mathbf{X=x}$ to close
assignment $r$:
\[
\delta: \mathcal{X} \rightarrow \{0,1\}.
\]
This leads to a treatment assignment set $\mathbb{T}$ defined as:
\[
\mathbb{T}\equiv \{ \mathbf{x}\in\mathcal{X}: \delta(\mathbf{x})=1 \}
\]
whose complement $\mathbb{T}^c$ is known as the control assignment
set. Finally then, we can write the treatment assignment rule:
\begin{equation}
\delta(x)\equiv \mathbf{1}_{\mathbf{x}\in\mathbb{T}}.
\end{equation}
Having defined the treatment assignment rule, we can now generalise
assumption \ref{Sass:SUTVAl}:

\begin{assumption}
\label{Sass:SUTVAlM}
\textbf{(B) Violations of SUTVA are observably local:} \\ 
For those individuals $i\notin J$ (ie for whom SUTVA does not hold), SUTVA is
violated due to observable spillovers $R(i,t)$, where 
$R(i,t)=\mathbf{1}_{\mathbf{x}\in \mathbb{T}}$, with the indicator function 
$\mathbf{1}$ now depending upon potentially multidimensional $\mathbf{X=x}$
fulfilling the treatment assignment rule $\mathbb{T}$.
\end{assumption}



\subsection{Semi-Parametric Estimation of Treatment Effects}


\section{Conclusion}
Echoing \citet{Bertrandetal2004}, ``Differences-in-Differences (DD) estimation has 
become an increasingly popular way to estimate causal relationships''.  It is 
important to consider the assumptions underlying these estimators.  
In this paper we examine how DD estimates perform when the stable unit treatment 
value assumption does not hold locally.  Such a situation may be common in estimates 
of the causal effect of policy where compliance is imperfect.  If policies entail a 
benefit to recipients, and if recipients living `close to' treatment areas who are 
themselves untreated can somehow cross regional boundaries to receive treatment, we 
may be concerned, that locally at least, SUTVA is violated.

In this paper we derive a set of conditions by which DD estimates can produce 
unbiased estimates even in the absence of SUTVA between all units.  It is shown
that under a weaker set of conditions, both the average effect on the treated
and the average effect on the `close to treated' can be estimated in a DD-type
framework.  It is suggested that in the absence of this correction for local 
violations of SUTVA that (if spillovers actually \emph{do} occur) the true 
effect of the policy is likely to be attenuated.  Finally, using two empirical 
examples from recent contraceptive policy expansions, it is shown that this---at
least in these cases---an important consideration for treatment effects, and
effects on nearby neighbourhoods.


\newpage
\bibliography{./biblio}
\newpage

\appendix
\section{Appendix Proofs}
\emph{Sketch of Proof of proposition \ref{Pass:ATT}}: Consider the regression 
model $Y(i,t)=\mu+\tau D(i,1) + \gamma R(i,1) + \delta t + \alpha D(i,t) + 
\beta R(i,t) + \varepsilon(i,t)$.  Now consider concentrating out $R(i,1)$, 
$R(i,t)$ to form $\tilde{y}(i,t)$.  Then appealing to SUTVA between $i$ such 
that $D(i,1)=1$ and $j$, (assumption 3), and appealing to assumption 1, we have 
that least squares estimation of $\tilde{y}(i,t)$ on a constant $D(i,1)$,
$D(i,t)$ and $t$ gives $E(\hat\alpha)=\alpha=ATT$.

Now, from the above model consider concentrating out $D(i,1)$ and $D(i,t)$
to form \emph{\"{y}}$(i,t)$.  Then appealing to SUTVA between $i$ such 
that $D(i,1)=0$ and $j$, (assumption 3), and appealing to assumption 2, we 
have that least squares estimation of \"{y}$(i,t)$ on a constant $R(i,1)$,
$R(i,t)$ and $t$ gives $E(\hat\beta)=\beta=ATC$. $\qed$



\section{Appendix Figures}
\label{Sscn:Agraphs}
\begin{figure}[htpb!]
\includegraphics[scale=0.8]{../results/Mexico/CloseEstimate2.eps}
\caption{Treatment and close to treatment effects: 20-24 year olds Mexico}
\end{figure}
\begin{figure}[htpb!]
\includegraphics[scale=0.8]{../results/Mexico/CloseEstimate3.eps}
\caption{Treatment and close to treatment effects: 25-29 year olds Mexico}
\end{figure}
\begin{figure}[htpb!]
\includegraphics[scale=0.8]{../results/Mexico/CloseEstimate4.eps}
\caption{Treatment and close to treatment effects: 30-39 year olds Mexico}
\end{figure}


\end{spacing}
\end{document}
